import sys
import os

# Добавляем src в путь
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src/v2'))


# Импортируем и тестируем
from utils.validators import parse_specifications

# Тест из твоего CSV
test_str = "HEPA (фильтр тонкой очистки): Нет / Pre Filter (фильтр предварительной очистки): Нет / Напряжение электропитания, В: 220 - 240 В"

result = parse_specifications(test_str)
print("Результат парсинга:")
for key, value in result.items():
    print(f"  {key}: {value}")

# Проверяем критичные поля
print(f"\nНапряжение: {result.get('Напряжение электропитания, В', 'НЕ НАЙДЕНО')}")
print(f"Масса товара (нетто): {result.get('Масса товара (нетто)', 'НЕ НАЙДЕНО')}")

# Тест с проблемным случаем из вывода
problem_str = "HEPA (фильтр тонкой очистки): Нет | Pre Filter (фильтр предварительной очистки): Нет | Антивандальное исполнение корпуса: Да | Вариант размещения: Вертикальное | Вид управления: Сенсорное | Вид установки (крепления): Настенная | Время непрерывной работы прибора: 1 мин | Высота товара: 24 см | Высота упаковки товара: 18 см | Гарантийный документ: Гарантийный талон | Гарантийный срок: 2 года | Глубина товара: 14.2 см | Глубина упаковки товара: 27.5 см | Длина кабеля: 1 м | Защита от перегрева: Да | Индикация включения: Нет | Класс пылевлагозащищенности: IPX1 | Количество режимов нагрева: 1 | Макс. потребляемая мощность: 2.5 кВт | Макс. скорость потока: 26 м|с | Максимальный уровень шума на выходе: 80 дБ | Масса товара (нетто): 5.1 кг | Масса товара с упаковкой (брутто): 5.5 кг | Материал корпуса: Нержавеющая сталь | Набор крепежных элементов в комплекте: Да | Напряжение электропитания, В: 220 - 240 В | Область применения: Офисное оборудование | Потребляемая мощность в режиме 'без нагрева': 2500 Вт | Серия: EHDA | Сетевой кабель: Да (с вилкой) | Срок службы: 5 лет | Страна производства: КНР | Температура воздуха на выходе: до 50 °С | Тип сушилки: Классическая | УФ-обеззараживание: Нет | Фильтры очистки воздуха: Нет | Форма корпуса: Дизайнерская | Цвет корпуса: Серый | Ширина товара: 27 см | Ширина упаковки товара: 30.5 см"

print("\n\nТест полной строки:")
result2 = parse_specifications(problem_str)
print(f"Масса товара (нетто): {result2.get('Масса товара (нетто)', 'НЕ НАЙДЕНО')}")
print(f"Напряжение: {result2.get('Напряжение электропитания, В', 'НЕ НАЙДЕНО')}")