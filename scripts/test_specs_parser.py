#!/usr/bin/env python3
"""
–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä—Å–µ—Ä–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
"""

import sys
import os
import json

# –î–æ–±–∞–≤–ª—è–µ–º src –≤ –ø—É—Ç—å Python
sys.path.insert(0, os.path.join(os.path.dirname(__file__), '..'))

from src.parsers.specs_parser import SpecsParser
from src.utils.logger import setup_logger


def test_specs_parser():
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫"""
    print("=" * 80)
    print("–¢–ï–°–¢ –ü–ê–†–°–ï–†–ê –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö")
    print("=" * 80)
    
    # –°–æ–∑–¥–∞–µ–º –ø–∞—Ä—Å–µ—Ä —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –¥–ª—è —Ç–µ—Å—Ç–∞
    main_attributes = [
        "–û–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è",
        "–ì–∞—Ä–∞–Ω—Ç–∏–π–Ω—ã–π —Å—Ä–æ–∫",
        "–¶–≤–µ—Ç –∫–æ—Ä–ø—É—Å–∞",
        "–°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞",
        "–ú–∞–∫—Å. –ø–æ—Ç—Ä–µ–±–ª—è–µ–º–∞—è –º–æ—â–Ω–æ—Å—Ç—å",
        "–ú–∞—Å—Å–∞ —Ç–æ–≤–∞—Ä–∞",
        "–®–∏—Ä–∏–Ω–∞ —Ç–æ–≤–∞—Ä–∞",
        "–ì–ª—É–±–∏–Ω–∞ —Ç–æ–≤–∞—Ä–∞",
        "–í—ã—Å–æ—Ç–∞ —Ç–æ–≤–∞—Ä–∞",
        "–°—Ä–æ–∫ —Å–ª—É–∂–±—ã",
        "–®—Ç—Ä–∏—Ö–∫–æ–¥"  # –î–æ–±–∞–≤–∏–º –¥–ª—è —Ç–µ—Å—Ç–∞
    ]
    
    parser = SpecsParser(main_attributes=main_attributes)
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤–∞—à–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
    test_cases = [
        # –ü—Ä–∏–º–µ—Ä 1: –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
        """–ê–≤–∞—Ä–∏–π–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –Ω–∞–∫–ª–æ–Ω–µ –∏–ª–∏ –æ–ø—Ä–æ–∫–∏–¥—ã–≤–∞–Ω–∏–∏: –ù–µ—Ç; 
        –í–∞—Ä–∏–∞–Ω—Ç —Ä–∞–∑–º–µ—â–µ–Ω–∏—è: –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ; 
        –í–∏–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è: –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–µ; 
        –í–∏–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–∫—Ä–µ–ø–ª–µ–Ω–∏—è): –ù–∞—Å—Ç–æ–ª—å–Ω–∞—è; 
        –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –≤–∞–Ω–Ω–æ–π –∫–æ–º–Ω–∞—Ç–µ: –ù–µ—Ç; 
        –í—ã—Å–æ—Ç–∞ —Ç–æ–≤–∞—Ä–∞: 19.5 —Å–º; 
        –í—ã—Å–æ—Ç–∞ —É–ø–∞–∫–æ–≤–∫–∏ —Ç–æ–≤–∞—Ä–∞: 20 —Å–º; 
        –ì–∞—Ä–∞–Ω—Ç–∏–π–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç: –ì–∞—Ä–∞–Ω—Ç–∏–π–Ω—ã–π —Ç–∞–ª–æ–Ω; 
        –ì–∞—Ä–∞–Ω—Ç–∏–π–Ω—ã–π —Å—Ä–æ–∫: 2 –≥–æ–¥–∞; 
        –ì–ª—É–±–∏–Ω–∞ —Ç–æ–≤–∞—Ä–∞: 10.5 —Å–º; 
        –ì–ª—É–±–∏–Ω–∞ —É–ø–∞–∫–æ–≤–∫–∏ —Ç–æ–≤–∞—Ä–∞: 12 —Å–º; 
        –î–ª–∏–Ω–∞ –∫–∞–±–µ–ª—è: 1.2 –º; 
        –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–º–µ—Ä–∑–∞–Ω–∏—è: false; 
        –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–≥—Ä–µ–≤–∞: –î–∞; 
        –ò–Ω–¥–∏–∫–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∏—è: –î–∞; 
        –ò–Ω–¥–∏–∫–∞—Ü–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–≥—Ä–µ–≤–∞: –ù–µ—Ç; 
        –ö–ª–∞—Å—Å –ø—ã–ª–µ–≤–ª–∞–≥–æ–∑–∞—â–∏—â–µ–Ω–Ω–æ—Å—Ç–∏: IP20; 
        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∂–∏–º–æ–≤ –Ω–∞–≥—Ä–µ–≤–∞: 1; 
        –ú–∞–∫—Å. –ø–æ—Ç—Ä–µ–±–ª—è–µ–º–∞—è –º–æ—â–Ω–æ—Å—Ç—å: 0.9 –∫–í—Ç; 
        –ú–∞—Å—Å–∞ —Ç–æ–≤–∞—Ä–∞ (–Ω–µ—Ç—Ç–æ): 0.48 –∫–≥; 
        –ú–∞—Å—Å–∞ —Ç–æ–≤–∞—Ä–∞ —Å —É–ø–∞–∫–æ–≤–∫–æ–π (–±—Ä—É—Ç—Ç–æ): 0.56 –∫–≥; 
        –ú–∞—Ç–µ—Ä–∏–∞–ª –∫–æ—Ä–ø—É—Å–∞: –ü–ª–∞—Å—Ç–∏–∫; 
        –ú–∞—Ç–µ—Ä–∏–∞–ª —Ä–µ—à–µ—Ç–∫–∏: –ü–ª–∞—Å—Ç–∏–∫; 
        –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–ø–∏—Ç–∞–Ω–∏—è, –í: 220 - 240 –í; 
        –û–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è: –ë—ã—Ç–æ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (–¥–ª—è –¥–æ–º–∞—à–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è); 
        –û—Ç—Å–µ–∫ –¥–ª—è —Å–µ—Ç–µ–≤–æ–≥–æ –∫–∞–±–µ–ª—è: false; 
        –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –¥–∏—Å–ø–ª–µ—è: –ù–µ—Ç; 
        –ü—Ä–æ—Ä–µ–∑–∏–Ω–µ–Ω–Ω—ã–µ –Ω–æ–∂–∫–∏: –ù–µ—Ç; 
        –ü—É–ª—å—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ: –ù–µ—Ç; 
        –†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ –º–æ—â–Ω–æ—Å—Ç–∏ –æ–±–æ–≥—Ä–µ–≤–∞: –î–∞; 
        –†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã: –ù–µ—Ç; 
        –†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —É–≥–ª–∞ –Ω–∞–∫–ª–æ–Ω–∞: –ù–µ—Ç; 
        –†–µ–∂–∏–º –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏ –±–µ–∑ –Ω–∞–≥—Ä–µ–≤–∞: –ù–µ—Ç; 
        –†—É—á–∫–∞ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è: –ù–µ—Ç; 
        –°–µ—Ä–∏—è: BFH/S; 
        –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–∂–∞—Ä–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: –î–∞; 
        –°–µ—Ç–µ–≤–æ–π –∫–∞–±–µ–ª—å: –î–∞ (—Å –≤–∏–ª–∫–æ–π); 
        –°—Ä–æ–∫ —Å–ª—É–∂–±—ã: 10 –ª–µ—Ç; 
        –°—Ç–µ–ø–µ–Ω—å –∑–∞—â–∏—Ç—ã / –ö–ª–∞—Å—Å –∑–∞—â–∏—Ç—ã: II; 
        –°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞: –ö–ù–†; 
        –°—Ç—É–ø–µ–Ω–∏ –º–æ—â–Ω–æ—Å—Ç–∏ –Ω–∞–≥—Ä–µ–≤–∞, –∫–í—Ç: 0,90 –∫–í—Ç; 
        –¢–∞–π–º–µ—Ä –Ω–∞ –≤–∫–ª—é—á–µ–Ω–∏–µ: –ù–µ—Ç; 
        –¢–∞–π–º–µ—Ä –Ω–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ: –ù–µ—Ç; 
        –¢–∏–ø –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞: –°–ø–∏—Ä–∞–ª—å–Ω—ã–π; 
        –¢–∏–ø —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç–∞: –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π; 
        –¢–æ—á–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã: –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞; 
        –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ c –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ Wi-Fi: –ù–µ—Ç; 
        –¶–≤–µ—Ç –∫–æ—Ä–ø—É—Å–∞: –ë–µ–ª—ã–π/–°–µ—Ä—ã–π; 
        –¶–∏—Ñ—Ä–æ–≤–æ–π –¥–∏—Å–ø–ª–µ–π: –ù–µ—Ç; 
        –®–∏—Ä–∏–Ω–∞ —Ç–æ–≤–∞—Ä–∞: 11.5 —Å–º; 
        –®–∏—Ä–∏–Ω–∞ —É–ø–∞–∫–æ–≤–∫–∏ —Ç–æ–≤–∞—Ä–∞: 12.3 —Å–º; 
        –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è –ø–æ–º–µ—â. –ø–ª–æ—â–∞–¥—å—é –¥–æ: 14 –º2""",
        
        # –ü—Ä–∏–º–µ—Ä 2: –°–ª–æ–∂–Ω—ã–π —Å–ª—É—á–∞–π —Å —Ä–∞–∑–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏
        """–û–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è: –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ; 
        –ì–∞—Ä–∞–Ω—Ç–∏–π–Ω—ã–π —Å—Ä–æ–∫: 3 –≥–æ–¥–∞; 
        –¶–≤–µ—Ç –∫–æ—Ä–ø—É—Å–∞: –ë–µ–ª—ã–π; 
        –°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞: –†–û–°–°–ò–Ø; 
        –ú–∞–∫—Å. –ø–æ—Ç—Ä–µ–±–ª—è–µ–º–∞—è –º–æ—â–Ω–æ—Å—Ç—å: 2 –∫–í—Ç; 
        –ú–∞—Å—Å–∞ —Ç–æ–≤–∞—Ä–∞ (–Ω–µ—Ç—Ç–æ): 5.9 –∫–≥; 
        –®–∏—Ä–∏–Ω–∞ —Ç–æ–≤–∞—Ä–∞: 94 —Å–º; 
        –ì–ª—É–±–∏–Ω–∞ —Ç–æ–≤–∞—Ä–∞: 12 —Å–º; 
        –í—ã—Å–æ—Ç–∞ —Ç–æ–≤–∞—Ä–∞: 22 —Å–º; 
        –°—Ä–æ–∫ —Å–ª—É–∂–±—ã: 7 –ª–µ—Ç; 
        –®—Ç—Ä–∏—Ö –∫–æ–¥: 4680551046830 / 4680551057614""",
        
        # –ü—Ä–∏–º–µ—Ä 3: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä
        "–¶–≤–µ—Ç: –ë–µ–ª—ã–π; –ú–æ—â–Ω–æ—Å—Ç—å: 1.5 –∫–í—Ç; –°—Ç—Ä–∞–Ω–∞: –ö–∏—Ç–∞–π",
        
        # –ü—Ä–∏–º–µ—Ä 4: –° –æ—à–∏–±–∫–∞–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞
        "–¶–≤–µ—Ç-–ë–µ–ª—ã–π; –ú–æ—â–Ω–æ—Å—Ç—å.1.5 –∫–í—Ç; –°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞:–ö–∏—Ç–∞–π",
        
        # –ü—Ä–∏–º–µ—Ä 5: –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
        "",
        
        # –ü—Ä–∏–º–µ—Ä 6: –¢–æ–ª—å–∫–æ –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ
        "–¶–≤–µ—Ç –∫–æ—Ä–ø—É—Å–∞: –ß–µ—Ä–Ω—ã–π",
        
        # –ü—Ä–∏–º–µ—Ä 7: –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∏ –±—É–ª–µ–≤—ã –∑–Ω–∞—á–µ–Ω–∏—è
        "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Wi-Fi: yes; –í–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º–æ—Å—Ç—å: true; –ì–∞—Ä–∞–Ω—Ç–∏—è: no"
    ]
    
    for i, test_case in enumerate(test_cases, 1):
        print(f"\n{'='*60}")
        print(f"–¢–ï–°–¢ {i}")
        print(f"{'='*60}")
        
        # –£–±–∏—Ä–∞–µ–º –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ –¥–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞
        compact_case = test_case.replace('\n', ' ').replace('  ', ' ')
        if len(compact_case) > 100:
            print(f"–í—Ö–æ–¥: {compact_case[:100]}...")
        else:
            print(f"–í—Ö–æ–¥: {compact_case}")
        
        result = parser.parse(test_case)
        
        if result.success:
            print(f"‚úÖ –£–°–ü–ï–®–ù–û —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–æ!")
            
            data = result.data
            stats = data['stats']
            
            print(f"\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
            print(f"   –í—Å–µ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫: {stats['total_specs']}")
            print(f"   –û—Å–Ω–æ–≤–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤: {stats['main_attributes_count']}")
            print(f"   –ù–∞–π–¥–µ–Ω —à—Ç—Ä–∏—Ö–∫–æ–¥: {'–î–∞' if stats['has_barcode'] else '–ù–µ—Ç'}")
            
            print(f"\nüéØ –û—Å–Ω–æ–≤–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è WC ({len(data['main_attributes'])}):")
            for key, value in data['main_attributes'].items():
                print(f"   ‚Ä¢ {key}: {value}")
            
            print(f"\nüìù –®—Ç—Ä–∏—Ö–∫–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:")
            barcode_info = data['barcode_info']
            if barcode_info['found']:
                print(f"   –ù–∞–π–¥–µ–Ω –≤ –ø–æ–ª–µ: '{barcode_info['key']}'")
                print(f"   –ó–Ω–∞—á–µ–Ω–∏–µ: {barcode_info['value']}")
                print(f"   –û—á–∏—â–µ–Ω–Ω—ã–π: {barcode_info['clean']}")
            else:
                print("   –ù–µ –Ω–∞–π–¥–µ–Ω")
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 5 —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
            print(f"\nüìã –ü–µ—Ä–≤—ã–µ 5 —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫:")
            for idx, spec in enumerate(data['specs_for_description'][:5], 1):
                main_flag = " (–æ—Å–Ω–æ–≤–Ω–æ–π)" if spec['is_main'] else ""
                print(f"   {idx}. {spec['key']}: {spec['value']}{main_flag}")
            
            if len(data['specs_for_description']) > 5:
                print(f"   ... –∏ –µ—â–µ {len(data['specs_for_description']) - 5} —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫")
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º HTML
            print(f"\nüîß HTML –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è (–ø–µ—Ä–≤—ã–µ 200 —Å–∏–º–≤–æ–ª–æ–≤):")
            html_preview = data['html_ready'][:200]
            if len(data['html_ready']) > 200:
                html_preview += "..."
            print(f"   {html_preview}")
            
            if result.warnings:
                print(f"\n‚ö†Ô∏è  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: {result.warnings}")
        
        else:
            print(f"‚ùå –û–®–ò–ë–ö–ò: {result.errors}")
        
        parser.log_parse_result(result, row_index=i)
        
        # –î–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –¥–µ–ª–∞–µ–º –ø–∞—É–∑—É
        if i < len(test_cases):
            print(f"\n{'='*60}")
            input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç: –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
    print(f"\n{'='*80}")
    print("–¢–ï–°–¢ –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–ò –ó–ù–ê–ß–ï–ù–ò–ô")
    print(f"{'='*80}")
    
    normalization_tests = [
        ("yes", "–î–∞"),
        ("no", "–ù–µ—Ç"),
        ("true", "–î–∞"),
        ("false", "–ù–µ—Ç"),
        ("–¥–∞", "–î–∞"),
        ("–Ω–µ—Ç", "–ù–µ—Ç"),
        ("–µ—Å—Ç—å", "–î–∞"),
        ("–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç", "–ù–µ—Ç"),
        ("1.5 –∫–≤—Ç", "1.5 –∫–í—Ç"),
        ("220 –≤–æ–ª—å—Ç", "220 –í"),
        ("True", "–î–∞"),
        ("False", "–ù–µ—Ç"),
        ("YES", "–î–∞"),
        ("NO", "–ù–µ—Ç"),
        ("–î–∞", "–î–∞"),
        ("–ù–µ—Ç", "–ù–µ—Ç"),
        ("true (–≤–∫–ª—é—á–µ–Ω–æ)", "–î–∞ (–≤–∫–ª—é—á–µ–Ω–æ)"),
        ("false –≤—ã–∫–ª—é—á–µ–Ω–æ", "–ù–µ—Ç –≤—ã–∫–ª—é—á–µ–Ω–æ"),
        ("1.2 –∫–≤—Ç.", "1.2 –∫–í—Ç"),
        ("50 –≤—Ç", "50 –í—Ç"),
        ("220 –≤–æ–ª—å—Ç.", "220 –í"),
        ("50 –≥–µ—Ä—Ü", "50 –ì—Ü"),
    ]
    
    print("\n–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:")
    all_passed = True
    
    for original, expected in normalization_tests:
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥ normalize_value
        actual = parser.normalize_value(original)
        status = "‚úÖ" if actual == expected else "‚ùå"
        
        if actual != expected:
            all_passed = False
        
        print(f"  {status} '{original}' ‚Üí '{actual}' (–æ–∂–∏–¥–∞–ª–æ—Å—å: '{expected}')")
    
    # –¢–µ—Å—Ç —Å –ø–æ–ª–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
    print(f"\n{'‚îÄ'*60}")
    print("–¢–µ—Å—Ç —Å –ø–æ–ª–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫:")
    
    full_test = "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: yes; –ó–∞—â–∏—Ç–∞: true; –ú–æ—â–Ω–æ—Å—Ç—å: 1.5 –∫–≤—Ç; –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ: 220 –≤–æ–ª—å—Ç"
    result = parser.parse(full_test)
    
    if result.success:
        print("‚úÖ –£—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–æ –ø–æ–ª–Ω—É—é —Å—Ç—Ä–æ–∫—É")
        for key, value in result.data['specs_dict'].items():
            print(f"  {key}: {value}")
    else:
        print("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ –ø–æ–ª–Ω–æ–π —Å—Ç—Ä–æ–∫–∏")
        all_passed = False
    
    print(f"\n{'='*80}")
    if all_passed:
        print("‚úÖ –í–°–ï –¢–ï–°–¢–´ –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–ò –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û!")
    else:
        print("‚ùå –ù–ï–ö–û–¢–û–†–´–ï –¢–ï–°–¢–´ –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–ò –ù–ï –ü–†–û–ô–î–ï–ù–´")
    print(f"{'='*80}")

    

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"""
    
    # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ª–æ–≥–≥–µ—Ä
    setup_logger(log_level="INFO", console_output=True)
    
    print("–ù–ê–ß–ê–õ–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø –ü–ê–†–°–ï–†–ê –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö")
    print()
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
    test_specs_parser()


if __name__ == "__main__":
    main()